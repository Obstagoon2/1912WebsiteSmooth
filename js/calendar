const apiKey = 'AIzaSyDFk7BVAYxUIngHdDOnVFD14XhnqdOSFDc';
const calendarId = 'ninq39q6r61rid4mot3h1ues5u3cmrdr@import.calendar.google.com';
const calendarContainer = document.getElementById('calendar-events');

async function loadEvents() {
    const timeMin = new Date().toISOString();
    const url = `https://www.googleapis.com/calendar/v3/calendars/${calendarId}/events?key=${apiKey}&timeMin=${timeMin}&singleEvents=true&orderBy=startTime`;

    try {
        const response = await fetch(url);
        const data = await response.json();

        if (data.items) {
            data.items.forEach(event => {
                const card = document.createElement('div');
                card.className = 'outreach-card';

                const content = document.createElement('div');
                content.className = 'event-content';

                const title = document.createElement('h2');
                title.className = 'event-title';
                title.textContent = event.summary;

                const date = document.createElement('div');
                date.className = 'event-date';
                const start = new Date(event.start.dateTime || event.start.date);
                date.textContent = start.toLocaleString(undefined, {
                    weekday: 'short', year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit'
                });

                const description = document.createElement('p');
                description.className = 'event-description';
                description.textContent = event.description || 'No description provided.';

                content.appendChild(title);
                content.appendChild(date);
                content.appendChild(description);
                card.appendChild(content);
                calendarContainer.appendChild(card);
            });
        } else {
            calendarContainer.innerHTML = '<p>No upcoming events found.</p>';
        }
    } catch (error) {
        console.error('Error fetching calendar events:', error);
        calendarContainer.innerHTML = '<p>Failed to load events.</p>';
    }
}

window.addEventListener('DOMContentLoaded', loadEvents);
